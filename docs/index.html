<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>NAO Library Assistant - Relazione Tecnica</title>
    <style>
        @page {
            size: A4;
            margin: 1.5cm;
        }
        
        body {
            font-family: 'Times New Roman', serif;
            font-size: 12pt;
            line-height: 1.6;
            color: #000;
            background: white;
            max-width: 21cm;
            margin: 0 auto;
            padding: 1.5cm;
        }
        
        .cover-page {
            text-align: center;
            padding-top: 4cm;
            page-break-after: always;
            position: relative;
            min-height: 25cm;
        }
        
        .university-logo {
            font-size: 24pt;
            font-weight: bold;
            color: #003366;
            margin-bottom: 1cm;
        }
        
        .main-title {
            font-size: 20pt;
            font-weight: bold;
            color: #1a1a1a;
            margin: 1cm 0;
            line-height: 1.4;
        }
        
        .subtitle {
            font-size: 16pt;
            color: #555;
            margin: 1.5cm 0;
        }
        
        .course-info {
            font-size: 14pt;
            margin: 2cm 0;
            line-height: 2;
        }
        
        .author-info {
            font-size: 14pt;
            margin: 2cm 0;
            line-height: 1.8;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
        }
        
        h1 {
            font-size: 18pt;
            font-weight: bold;
            color: #1a1a1a;
            margin-top: 30px;
            margin-bottom: 15px;
            border-bottom: 2px solid #333;
            padding-bottom: 5px;
        }
        
        h2 {
            font-size: 14pt;
            font-weight: bold;
            color: #333;
            margin-top: 25px;
            margin-bottom: 12px;
            border-bottom: 1px solid #ccc;
            padding-bottom: 3px;
        }
        
        h3 {
            font-size: 13pt;
            font-weight: bold;
            color: #555;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        h4 {
            font-size: 12pt;
            font-weight: bold;
            color: #666;
            margin-top: 15px;
            margin-bottom: 8px;
        }
        
        .toc {
            page-break-after: always;
            margin-top: 2cm;
        }
        
        .toc-title {
            font-size: 18pt;
            font-weight: bold;
            text-align: center;
            margin-bottom: 2cm;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }
        
        .toc-item {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            border-bottom: 1px dotted #ccc;
            padding-bottom: 2px;
        }
        
        .info-box {
            background: #f8f9fa;
            border: 2px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .warning-box {
            background: #fff3cd;
            border: 2px solid #856404;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 5px solid #856404;
        }
        
        .success-box {
            background: #d4edda;
            border: 2px solid #155724;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 5px solid #155724;
        }
        
        .code-block {
            background: #f1f3f4;
            border-left: 4px solid #4285f4;
            padding: 15px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 10pt;
            white-space: pre-wrap;
            overflow-x: auto;
            border-radius: 4px;
        }
        
        .architecture-diagram {
            border: 2px solid #333;
            padding: 25px;
            margin: 25px 0;
            text-align: center;
            background: #fafafa;
            font-family: 'Courier New', monospace;
            font-size: 9pt;
            white-space: pre;
            border-radius: 5px;
        }
        
        .directory-tree {
            font-family: 'Courier New', monospace;
            font-size: 10pt;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 20px;
            margin: 20px 0;
            white-space: pre;
            border-radius: 5px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 11pt;
        }
        
        th, td {
            border: 1px solid #333;
            padding: 10px;
            text-align: left;
        }
        
        th {
            background-color: #e9ecef;
            font-weight: bold;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        ul, ol {
            margin-left: 25px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 5px;
        }
        
        .page-break {
            page-break-before: always;
        }
        
        .figure-caption {
            text-align: center;
            font-style: italic;
            margin-top: 10px;
            color: #666;
        }
        
        .emphasis {
            background-color: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        @media print {
            body {
                margin: 0;
                padding: 1cm;
                font-size: 11pt;
            }
            .no-print {
                display: none;
            }
            .cover-page {
                padding-top: 2cm;
            }
        }
    </style>
</head>
<body>

    <!-- PAGINA DI COPERTINA -->
    <div class="cover-page">
        <div class="university-logo">
            UNIVERSITÀ DEGLI STUDI DI PALERMO<br>
            FACOLTÀ DI INGEGNERIA
        </div>
        
        <div class="main-title">
            RELAZIONE TECNICA<br>
            SISTEMA NAO LIBRARY ASSISTANT<br>
            CON INTEGRAZIONE ROS2-WEBOTS
        </div>
        
        <div class="author-info">
            <strong>Sviluppatori:</strong> Petrone Kevin, Di Peri Marta, Cirincione Marika<br>
            <strong>Matricola:</strong> 0774409, 0774023, 0772935<br>
            <strong>Docente:</strong> Seidita Valeria
        </div>
        
        <div class="subtitle">
            Progetto per esame di<br>programmazione dei robot<br>Scenario 3
        </div>
        
        <div class="course-info">
            <strong>Corso:</strong> Ing. Robotica<br>
            <strong>Anno Accademico:</strong> 2024/2025<br>
            <strong>Data:</strong> Giugno 2025<br><br>
            <strong>Tecnologie:</strong><br>
            ROS2 Humble • Webots R2025a • Python 3.10
        </div>
    </div>

    <!-- INDICE -->
    <div class="toc">
        <div class="toc-title">INDICE</div>
        
        <div class="toc-item">
            <span>1. INTRODUZIONE</span>
        </div>
        <div class="toc-item">
            <span>2. BASE DI CONOSCENZA, GESTIONE DATABASE</span>
        </div>
        <div class="toc-item">
            <span>3. ARCHITETTURA DEL SISTEMA</span>
        </div>
        <div class="toc-item">
            <span>4. MAPPATURA NODI/TOPIC ROS</span>
        </div>
        <div class="toc-item">
            <span>5. INTERFACCIA UTENTE</span>
        </div>
        <div class="toc-item">
            <span>6. SISTEMA DI NAVIGAZIONE</span>
        </div>
        <div class="toc-item">
            <span>7. STRUTTURA DEL PROGETTO</span>
        </div>
        <div class="toc-item">
            <span>8. INSTALLAZIONE E CONFIGURAZIONE</span>
        </div>
        <div class="toc-item">
            <span>9. RISOLUZIONE PROBLEMI</span>
        </div>
        <div class="toc-item">
            <span>10. CONCLUSIONI</span>
        </div>
    </div>

    <!-- CONTENUTO PRINCIPALE -->
    <h1>1. INTRODUZIONE</h1>
    
    <p>Il progetto <strong>NAO Library Assistant</strong> rappresenta un sistema robotico avanzato che integra <span class="emphasis">ROS2 (Robot Operating System 2)</span> con il simulatore <span class="emphasis">Webots R2025a</span> per controllare un robot NAO virtuale in un ambiente bibliotecario simulato.</br>Il sistema permette all'utente di interagire tramite comandi testuali per richiedere libri specifici, mentre il robot NAO risponde alle richieste e naviga autonomamente tra gli scaffali della biblioteca per accompagnare l'utente allo scaffale del libro richiesto, dimostrando un'applicazione pratica della robotica di servizio.</p>

    <h2>1.1 Obiettivi del Sistema</h2>
	<ul>
		<li>Fornire informazioni dettagliate sui libri presenti nella biblioteca</li>
		<li>Aggiornare e comunicare lo stato di disponibilità dei volumi</li>
		<li>Accompagnare virtualmente l’utente fino allo scaffale che contiene il libro desiderato</li>
	</ul>

    <h2>1.2 Comportamento atteso del robot</h2>
    <p>Il comportamento del robot si sviluppa in modo strutturato: saluta l’utente, propone una lista di opzioni numerate da 1 a 9 (relative a informazioni su autore, genere, anno, disponibilità, trama, posizione, accompagnamento, restituzione e gestione), interpreta la scelta e risponde con l’audio appropriato. Se viene scelta l’opzione 7, il robot si muove nello spazio simulato fino allo scaffale selezionato, parlando tramite audio durante il tragitto, e infine ritorna alla posizione iniziale.</p>

	<h2>1.3 Dominio del sistema</h2>
    
    <p>
    Il progetto è ambientato in una biblioteca semistrutturata, dove il robot <strong>NAO</strong> assiste gli utenti nella ricerca e consultazione dei libri. 
    L’ambiente è stato ricostruito fedelmente a partire da una <strong>scansione reale dell’aula</strong>, modellata in <strong>Fusion 360</strong> e poi convertita nei formati 
    OBJ e MTL. I modelli sono stati infine importati in <strong>Webots</strong> come solidi CADShape, per garantire una simulazione coerente e realistica.
    </p>  
     
    <div style="text-align: center; margin-top: 20px;">
        <img src="https://raw.githubusercontent.com/KevinPetrone/Nao-Library-Assistant/main/images/aula_foto.png" alt="Scansione dell'aula" style="max-width: 90%; height: auto; border: 1px solid #ccc; border-radius: 8px;">
        <p style="font-style: italic; color: #555;">Figura 1 – Rappresentazione dell'aula scansionata e ricostruita</p>
    </div>

    <div class="page-break"></div>

    <h1>2. BASE DI CONOSCENZA, GESTIONE DATABASE</h1>

    <h2>2.1 Descrizione Della Base Di Conoscenza</h2>

    <p>Il sistema robotico impiegato nel progetto “Servizio in biblioteca” si basa su una base di conoscenza strutturata in formato JSON, progettata per rappresentare in modo dettagliato l’insieme dei libri presenti nella biblioteca simulata. Ogni libro è descritto come un oggetto JSON autonomo, composto da una serie di attributi chiave che ne delineano sia le caratteristiche bibliografiche sia le informazioni logistiche. All’interno del progetto, questa base di conoscenza costituisce il nucleo informativo del sistema: consente al robot di comprendere e rispondere in maniera coerente e contestualizzata alle richieste dell’utente, fungendo da interfaccia tra l’interazione vocale e i dati memorizzati.
Dal punto di vista concettuale, la base di conoscenza può essere interpretata come una sorta di ontologia descrittiva, in cui le relazioni tra entità (ad esempio: “il libro ha autore”, “il libro appartiene a un genere”, “il libro si trova in una posizione”) sono implicitamente definite tramite i campi del JSON.</p>

    <h2>2.2 Struttura Database JSON</h2>
    
    <p>La base di conoscenza è costituito da un database <code>database_libri.json</code> che utilizza una struttura JSON ottimizzata per ricerche rapide:</p>

    <div class="code-block">{
  "Il Signore degli Anelli": {
      "titolo": "Il Signore degli Anelli",
      "autore": "J.R.R. Tolkien", 
      "genere": "Fantasy epico",
      "anno": 1954,
      "disponibile": true,
      "carta_biblioteca": true,
      "trama": "...",
      "location": {...}
    },
    "Dune": {
      "titolo": "Dune",
      "autore": "Frank Herbert",
      "genere": "Fantascienza", 
      "anno": 1965,
      "disponibile": true,
      "carta_biblioteca": true,
      "trama": "...",
      "location": {...}
    },
    "Il nome della Rosa":{
      "titolo": "Il Nome della Rosa",
      "autore": "Umberto Eco",
      "genere": "Gialli storico",
      "anno": 1980,
      "disponibile": true,
      "carta_biblioteca": true,
      "trama": "...",
      "location": {...}
    }
    }</div>

    <h2>2.3 Classe Database Manager</h2>
    
    <p>Questo codice serve a gestire e cercare i dati di una biblioteca. In pratica:<br>
        <li>La classe LibraryDatabase rappresenta un gestore del database dei libri.</li>
        <li>Carica i dati dei libri da un file JSON e li memorizza per essere consultati.</li>
        <li>Permette di cercare libri per titolo, autore o genere grazie al metodo search_book, dopo aver reso la ricerca case-insensitive.</li>
        <li>Restituisce il libro trovato oppure None se non trova niente.</li></p>

    <div class="code-block">class LibraryDatabase:
    def __init__(self, database_path):
        self.database_path = database_path
        self.books_data = self.load_database()
    
    def search_book(self, query):
        """Ricerca libro per titolo, autore o genere"""
        query_lower = query.lower()
        
        for book in self.books_data['libri']:
            if (query_lower in book['titolo'].lower() or
                query_lower in book['autore'].lower() or
                query_lower in book['genere'].lower()):
                
                return book
        return None
    
    def get_books_by_shelf(self, shelf_row):
        """Ottiene tutti i libri di uno scaffale specifico"""
        return [book for book in self.books_data['libri'] 
                if book['shelf_row'] == shelf_row and book['disponibile']]</div>

    <h2>2.4 Grafo Ontologia OWL</h2>
    <p>Le frecce colorate rappresentano relazioni semantiche (es. “ha autore”, “è di genere”, “è collocato in”).<br><br>I diamanti e cerchi indicano classi e istanze distinte.<br><br>Alcuni nodi (come “JKRowling” o “Fantasy”) rappresentano esempi di individui usati a scopo illustrativo.</p>
    <div style="text-align: center; margin-top: 20px;">
        <img src="https://raw.githubusercontent.com/KevinPetrone/Nao-Library-Assistant/main/images/mappa_owl.jpg" alt="Scansione dell'aula" style="max-width: 90%; height: auto; border: 1px solid #ccc; border-radius: 8px;">
        <p style="font-style: italic; color: #555;">Figura 2 – Rappresentazione Ontograf</p>
    </div>
    <h1>3. ARCHITETTURA DEL SISTEMA</h1>

    <h2>3.1 Schema Generale dell'Architettura</h2>
    
    <div class="architecture-diagram">
┌─────────────────────────────────────────────────────────────────┐
│                    SISTEMA NAO LIBRARY ASSISTANT                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌──────────────────┐    ┌─────────────┐ │
│  │   INTERFACCIA   │    │   ELABORAZIONE   │    │ SIMULAZIONE │ │
│  │     UTENTE      │    │     LOGICA       │    │   FISICA    │ │
│  │                 │    │                  │    │             │ │
│  │ ┌─────────────┐ │    │ ┌──────────────┐ │    │ ┌─────────┐ │ │
│  │ │ Keyboard    │ │    │ │ Library      │ │    │ │ Webots  │ │ │
│  │ │ Input Node  │ │───>| | Assistant    │ │───>| | NAO     │ │ │
│  │ │             │ │    │ │              │ │    │ │ Robot   │ │ │
│  │ └─────────────┘ │    │ └──────────────┘ │    │ └─────────┘ │ │
│  │                 │    │ ┌──────────────┐ │    │ ┌─────────┐ │ │
│  │                 │    │ │ Database     │ │    │ │ Library │ │ │
│  │                 │    │ │ Manager      │ │    │ │ World   │ │ │
│  │                 │    │ │              │ │    │ │         │ │ │
│  │                 │    │ └──────────────┘ │    │ └─────────┘ │ │
│  └─────────────────┘    └──────────────────┘    └─────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘</div>
    
    <div class="figure-caption">Figura 3: Architettura generale del sistema NAO Library Assistant</div>
    
    <h2>3.2 Componenti del Sistema</h2>

    <h3>3.2.1 Nodi ROS2</h3>
    <table>
        <tr>
            <th>Nodo</th>
            <th>Funzione</th>
            <th>Tipo</th>
        </tr>
        <tr>
            <td><strong>keyboard_input_node</strong></td>
            <td>Gestisce l'input utente da tastiera e pubblica comandi</td>
            <td>Publisher</td>
        </tr>
        <tr>
            <td><strong>library_assistant</strong></td>
            <td>Elabora richieste utente, gestisce database e logica di business</td>
            <td>Subscriber/Publisher</td>
        </tr>
        <tr>
            <td><strong>nao_controller_node</strong></td>
            <td>Bridge tra ROS2 e controllo robot Webots</td>
            <td>Subscriber</td>
        </tr>
    </table>

    <h3>3.2.2 Topics di Comunicazione</h3>
    <table>
        <tr>
            <th>Topic</th>
            <th>Tipo Messaggio</th>
            <th>Descrizione</th>
        </tr>
        <tr>
            <td><strong>user_input</strong></td>
            <td>String</td>
            <td>Trasporta comandi utente dal nodo di input</td>
        </tr>
        <tr>
            <td><strong>nao_speech</strong></td>
            <td>String</td>
            <td>Comandi vocali e messaggi per il robot NAO</td>
        </tr>
        <tr>
            <td><strong>nao_movement</strong></td>
            <td>Int32</td>
            <td>Comandi di movimento specifici per navigazione</td>
        </tr>
    </table>

    <div class="page-break"></div>

    <h1>4. MAPPATURA NODI/TOPIC ROS</h1>

    <h2>4.1 Diagramma di Flusso Dati</h2>

    <p>Un diagramma di flusso rappresenta visivamente come i diversi componenti software (i nodi ROS) comunicano tra loro usando i topic:</p>

    <ol>
        <li><strong>Input Utente</strong>: L'utente digita un comando specifico nel terminale</li>
        <li><strong>Pubblicazione</strong>: Il nodo keyboard_input_node pubblica il comando sul topic 'user_input'</li>
        <li><strong>Elaborazione</strong>: Il nodo library_assistant riceve e processa la richiesta utente</li>
        <li><strong>Database Query</strong>: Viene effettuata una ricerca nel file database_libri.json</li>
        <li><strong>Comando Movimento</strong>: Viene pubblicato sul topic 'nao_movement' il codice shelf_row</li>
        <li><strong>Controllo Robot</strong>: Il nodo nao_controller_node riceve il comando e attiva il percorso</li>
        <li><strong>Simulazione</strong>: Webots esegue fisicamente i movimenti del robot NAO virtuale</li>
    </ol>

    <div class="architecture-diagram">
┌─────────────┐     user_input      ┌─────────────────┐
│  Keyboard   │────────────────────▶│ Library         │
│  Input      │      (String)       │ Assistant       │
│  Node       │                     │                 │
└─────────────┘                     └─────────────────┘
                                    │
                                                 │ nao_movement
                                            │ (Int32)
                                    ▼
                                    ┌─────────────────┐
                                    │ NAO Controller  │
                                    │ Node            │
                                    │                 │
                                    └─────────────────┘
                                    │
                                                   │ Robot Commands
                                    ▼
                                    ┌─────────────────┐
                                    │ Webots NAO      │
                                    │ Simulation      │
                                    │                 │
                                    └─────────────────┘</div>

    <div class="success-box">
        <strong>✅ Vantaggi dell'Architettura:</strong><br>
        L'utilizzo del pattern Publisher-Subscriber di ROS2 garantisce un disaccoppiamento completo tra i componenti, permettendo modularità e facilità di manutenzione del sistema.
    </div>

    <div class="page-break"></div>

    <h1>5. INTERFACCIA UTENTE</h1>

    <h2>5.1 Avvio del Sistema</h2>

    <p>
        Per avviare correttamente il sistema sono necessari <strong>due terminali</strong>, poiché 
        <strong>ROS 2 non gestisce automaticamente l'esecuzione parallela dei nodi</strong>. 
        Ogni nodo o processo va lanciato manualmente (o tramite script) in un terminale dedicato.
    </p>

    <h3>Terminale 1 – Simulazione Webots + Robot</h3>
    <p>
        Avvia la simulazione in <strong>Webots</strong> con il robot <strong>NAO</strong> e i nodi principali ROS 2. 
        Questo terminale mette il robot in <strong>attesa dei comandi</strong> da parte dell’utente.
    </p>

    <h3>Terminale 2 – Interfaccia utente (input da tastiera)</h3>
    <p>
        Avvia il nodo ROS 2 che gestisce l'<strong>interazione con l'utente</strong>. 
        Permette all'utente di inviare comandi tramite tastiera 
        (es. <em>richiedere informazioni su un libro</em> o <em>farsi guidare a uno scaffale</em>).
    </p>
    
    <div class="code-block"># Terminal 1: Avvio sistema principale
cd ~/nao_library_ws/src/nao_library_assistant
chmod +x start_nao_library.sh
./start_nao_library.sh

# Terminal 2: Avvio interfaccia utente (in parallelo)
cd ~/nao_library_ws
source /opt/ros/humble/setup.bash
source install/setup.bash
ros2 run nao_library_assistant keyboard_input_node</div>

    <h2>5.2 Keyboard Input Node</h2>
    
    <p>Il modulo <code>keyboard_input_node.py</code> gestisce l'interazione utente attraverso un'interfaccia a riga di comando intuitiva:</p>

    <div class="code-block">class KeyboardInputNode(Node):
    def __init__(self):
        super().__init__('keyboard_input_node')
        self.user_input_pub = self.create_publisher(String, 'user_input', 10)
        
    def keyboard_input_loop(self):
        """Loop principale per input utente"""
        print("=== NAO LIBRARY ASSISTANT ===")
        print("Comandi disponibili:")
        print("1-9: Menù dei comandi")
        print("Nome libro: Ricerca diretta nel catalogo")
        print("CTRL+C: Uscita dal sistema")
        print("=" * 30)
        
        while rclpy.ok():
            try:
                current_input = input("📚 Comando > ")
                if current_input.strip():
                    self.publish_user_input(current_input.strip())
            except KeyboardInterrupt:
                print("\n👋 Uscita dal sistema...")
                break</div>

    <h2>5.3 Comandi Disponibili</h2>
    
    <table>
        <tr>
            <th>Comando</th>
            <th>Azione</th>
            <th>Esempio</th>
        </tr>
        <tr>
            <td>1-9</td>
            <td>Menù dei comandi</td>
            <td><code>5</code> → Leggi la TRAMA di un libro</td>
        </tr>
        <tr>
            <td>Nome libro</td>
            <td>Ricerca nel database per titolo</td>
            <td><code>Il Signore degli Anelli</code></td>
        </tr>
        <tr>
            <td>CTRL+C</td>
            <td>Uscita sicura dal sistema</td>
            <td>Terminazione controllata</td>
        </tr>
    </table>
    <p>Il comando 1-9, offre 9 richieste da input da tastiera, tra cui:</p>
    <table>
        <tr>
            <th>Tasto</th>
            <th>Richiesta</th>
        </tr>
        <tr>
            <td >1️⃣</td>
            <td>Cerca per AUTORE</td>
        </tr>
        <tr>
            <td>2️⃣</td>
            <td>Cerca per GENERE</td>
        </tr>
        <tr>
            <td>3️⃣</td>
            <td>Cerca per ANNO</td>
        </tr>
        <tr>
            <td>4️⃣</td>
            <td>Verifica DISPONIBILITÀ di un libro</td>
        </tr>
        <tr>
            <td>5️⃣</td>
            <td>Leggi la TRAMA di un libro</td>
        </tr>
        <tr>
            <td>6️⃣</td>
            <td>Trova la POSIZIONE di un libro</td>
        </tr>
        <tr>
            <td>7️⃣</td>
            <td>Voglio essere ACCOMPAGNATO a un libro specifico</td>
        </tr>
        <tr>
            <td>8️⃣</td>
            <td>RESTITUISCI un libro</td>
        </tr>
        <tr>
            <td>9️⃣</td>
            <td>GESTISCI libri (Aggiungi/Modifica/Elimina) "gestita da password"</td>
        </tr>
    </table>

    <h2>5.4 Interfaccia Feedback</h2>
    
    <div class="info-box">
        <strong>🖥️ Messaggi di Sistema:</strong>
        <ul>
            <li><strong>Ricerca riuscita</strong>: "📖 Libro trovato: [Titolo] - Scaffale [N]"</li>
            <li><strong>Navigazione</strong>: "🤖 NAO si sta dirigendo verso lo scaffale [N]"</li>
            <li><strong>Completamento</strong>: "✅ Missione completata - Scaffale raggiunto"</li>
            <li><strong>Errore</strong>: "❌ Libro non trovato nel catalogo"</li>
        </ul>
    </div>

    <div class="page-break"></div>

    <h1>6. SISTEMA DI NAVIGAZIONE</h1>

    <h2>6.1 Mappatura Biblioteca</h2>
    
    <p>Il robot utilizza un sistema di <strong>percorsi predefiniti</strong> ottimizzati per raggiungere diverse sezioni della biblioteca. Ogni scaffale è associato a una sequenza specifica di movimenti:</p>

    <div class="code-block">self.shelf_row_paths = {
    1: [  # Scaffale Scienza e Cucina
        {"action": "FORWARD", "distance": 1.0},
        {"action": "TURN_LEFT", "angle": 45},
        {"action": "FORWARD", "distance": 6.5},
        {"action": "WAIT", "time": 10},
        {"action": "RETURN_HOME"}
    ],
    2: [  # Scaffale Bambini Ragazzi e Fantasy Fantascienza
        {"action": "FORWARD", "distance": 1.0},
        {"action": "TURN_RIGHT", "angle": 100},
        {"action": "FORWARD", "distance": 1.57},
        {"action": "WAIT", "time": 10},
        {"action": "RETURN_HOME"}
    ],
    3: [  # Scaffale Gialli e Narrativa
        {"action": "FORWARD", "distance": 2.0},
        {"action": "TURN_LEFT", "angle": 90},
        {"action": "FORWARD", "distance": 3.0},
        {"action": "WAIT", "time": 10},
        {"action": "RETURN_HOME"}
    ]
}</div>

<div class="success-box">
        <strong>✅ Vantaggi del Sistema di Navigazione:</strong>
        <ul>
            <li><strong>Affidabilità</strong>: Percorsi testati e ottimizzati per ogni destinazione</li>
            <li><strong>Prevedibilità</strong>: Comportamento robot sempre coerente e ripetibile</li>
            <li><strong>Efficienza</strong>: Movimenti diretti senza calcoli real-time complessi</li>
            <li><strong>Manutenibilità</strong>: Facile modifica e aggiunta di nuovi percorsi</li>
        </ul>
    </div>

    <div class="page-break"></div>

    <h1>7. STRUTTURA DEL PROGETTO</h1>

    <h2>7.1 Organizzazione Directory</h2>
    
    <p>
    Questa directory rappresenta l’organizzazione completa del progetto <strong>NAO Library Assistant</strong>, 
    è strutturata per raccogliere in modo ordinato tutti i file e le cartelle necessari al 
    <strong>funzionamento del progetto</strong>.
    </p>

    <div class="directory-tree">nao_library_ws/
├── src/nao_library_assistant/
│   ├── nao_library_assistant/          # Moduli Python ROS2
│   │   ├── __init__.py
│   │   ├── keyboard_input_node.py      # Gestione input tastiera
│   │   ├── library_assistant.py        # Logica principale sistema
│   │   ├── library_database.py         # Interfaccia database
│   │   └── nao_controller_node.py      # Controller robot Webots
│   ├── controllers/go_library/         # Controller Webots
│   │   └── go_library.py               # Bridge ROS2-Webots
│   ├── data/
│   │   ├── database_libri.json         # Database catalogo biblioteca
│   │   └── password.json               # password riservata al personale
│   ├── worlds/
│   │   ├── esame_Nao.wbt               # Mondo Webots biblioteca
│   │   └── oggetti.obj                 # Oggetti obj e mtl per l'ambiente
│   ├── motions/                        # File movimenti preregistrati
│   │   ├── Forwards50.motion
│   │   ├── TurnLeft60.motion
│   │   ├── TurnRight60.motion
│   │   └── HandWave.motion
│   ├── launch/
│   │   └── nao_library.launch.py       # File lancio sistema
│   ├── Audio/                          # File audio sistema
│   ├── package.xml                     # Configurazione pacchetto
│   ├── setup.py                        # Setup Python
│   └── start_nao_library.sh            # Script avvio rapido
└── install/                            # Directory build (generata automaticamente)
    └── nao_library_assistant/
        ├── lib/nao_library_assistant/  # Eseguibili compilati
        │   ├── keyboard_input_node
        │   ├── library_assistant
        │   └── nao_controller_node
        └── share/nao_library_assistant/ # Risorse condivise
            ├── launch/
            ├── worlds/
            ├── controllers/
            └── data/</div>

    <h2>7.2 Importanza della Directory Install</h2>
    
    <div class="warning-box">
        <strong>⚠️ ATTENZIONE CRITICA:</strong><br>
        La directory <code>install/</code> è generata automaticamente dal comando <code>colcon build</code> e contiene:
        <ul>
            <li><strong>Eseguibili compilati</strong>: Versioni ottimizzate pronte per l'esecuzione</li>
            <li><strong>Moduli Python installati</strong>: Importabili direttamente dal sistema ROS2</li>
            <li><strong>Risorse condivise</strong>: Launch files, mondi Webots, database e configurazioni</li>
        </ul>
        <strong>Senza questa directory, il sistema non può funzionare!</strong>
    </div>

    <h2>7.3 File di Configurazione Principali</h2>
    
    <table>
        <tr>
            <th>File</th>
            <th>Scopo</th>
            <th>Formato</th>
        </tr>
        <tr>
            <td>package.xml</td>
            <td>Metadati pacchetto ROS2, dipendenze</td>
            <td>XML</td>
        </tr>
        <tr>
            <td>setup.py</td>
            <td>Configurazione installazione Python</td>
            <td>Python</td>
        </tr>
        <tr>
            <td>database_libri.json</td>
            <td>Catalogo biblioteca con mappatura scaffali</td>
            <td>JSON</td>
        </tr>
        <tr>
            <td>esame_Nao.wbt</td>
            <td>Mondo 3D Webots con ambiente biblioteca</td>
            <td>Webots World</td>
        </tr>
    </table>

    <div class="page-break"></div>

    <h1>8. INSTALLAZIONE E CONFIGURAZIONE</h1>

    <h2>8.1 Prerequisiti Software</h2>
    
    <div class="warning-box">
        <strong>⚠️ IMPORTANTE:</strong> Utilizzare esclusivamente <strong>Webots R2025a</strong> (non R2023b o versioni precedenti) per garantire piena compatibilità con il sistema.
    </div>

    <table>
        <tr>
            <th>Software</th>
            <th>Versione Richiesta</th>
            <th>Comando Verifica</th>
        </tr>
        <tr>
            <td>ROS2 Humble</td>
            <td>Humble Hawksbill</td>
            <td><code>ros2 --version</code></td>
        </tr>
        <tr>
            <td>Webots</td>
            <td>R2025a</td>
            <td><code>webots --version</code></td>
        </tr>
        <tr>
            <td>Python</td>
            <td>3.10+</td>
            <td><code>python3 --version</code></td>
        </tr>
        <tr>
            <td>Colcon</td>
            <td>Latest</td>
            <td><code>colcon --help</code></td>
        </tr>
    </table>

    <h2>8.2 Procedura di Installazione Completa</h2>

    <h3>Step 1: Preparazione su PC Sviluppo</h3>
    
    <div class="code-block"># Verifica prerequisiti sistema
echo $ROS_DISTRO        # Deve mostrare ROS2 Humble
webots --version        # Deve mostrare Webots R2025a
python3 --version       # Deve essere 3.10 o superiore
colcon --help           # Verifica build tool</div>

    <h3>Step 2: Creazione Archivio per Trasferimento</h3>
    
    <div class="code-block"># Creare archivio completo incluso codice sorgente
cd ~/
tar -czf nao_library_complete.tar.gz nao_library_ws/

# Verifica dimensione archivio (dovrebbe essere circa 50-100MB)
ls -lh nao_library_complete.tar.gz</div>

    <h3>Step 3: Installazione su PC Destinazione</h3>
    
    <div class="code-block"># Trasferire archivio al PC di destinazione
scp nao_library_complete.tar.gz utente@pc-destinazione:~/

# Accedere al PC destinazione
ssh utente@pc-destinazione

# Scompattare archivio
cd ~/
tar -xzf nao_library_complete.tar.gz

# Configurare ambiente ROS2
source /opt/ros/humble/setup.bash

# REBUILD OBBLIGATORIO su ogni nuovo PC
cd nao_library_ws/
colcon build --packages-select nao_library_assistant

# Configurare workspace locale
source install/setup.bash</div>

    <h2>8.3 Verifica Installazione</h2>
    
    <div class="code-block"># Verificare creazione eseguibili
ls install/lib/nao_library_assistant/
# Output atteso:
# keyboard_input_node  library_assistant  nao_controller_node

# Verificare risorse condivise  
ls install/share/nao_library_assistant/
# Output atteso:
# controllers/  data/  launch/  worlds/

# Test rapido sistema
ros2 pkg list | grep nao_library_assistant
# Deve mostrare: nao_library_assistant</div>

    <div class="success-box">
        <strong>✅ Controllo Installazione Riuscita:</strong><br>
        Se tutti i comandi precedenti producono l'output atteso, l'installazione è completata con successo e il sistema è pronto per l'utilizzo.
    </div>

    <div class="page-break"></div>

    <h1>9. RISOLUZIONE PROBLEMI COMUNI</h1>

    <h2>9.1 Errori di Build</h2>
    
    <div class="code-block"># Problema: "Package not found during build"
# Soluzione: Pulizia completa e rebuild
rm -rf build/ install/ log/
colcon build --packages-select nao_library_assistant
source install/setup.bash

# Problema: "Permission denied" 
# Soluzione: Correzione permessi
chmod +x src/nao_library_assistant/start_nao_library.sh
sudo chown -R $USER:$USER nao_library_ws/</div>

    <h2>9.2 Errori Webots</h2>
    
    <div class="code-block"># Problema: "Webots not found in PATH"
# Soluzione: Aggiunta al PATH di sistema
export PATH=$PATH:/usr/local/webots/bin
echo 'export PATH=$PATH:/usr/local/webots/bin' >> ~/.bashrc

# Problema: "World file not loading"
# Soluzione: Verifica percorsi relativi
ls install/share/nao_library_assistant/worlds/esame_Nao.wbt</div>

    <h2>9.3 Errori ROS2</h2>
    
    <div class="code-block"># Problema: "Node not found"
# Soluzione: Verifica sourcing ambiente
source /opt/ros/humble/setup.bash
source install/setup.bash
ros2 pkg list | grep nao_library_assistant

# Problema: "Topics not publishing"
# Soluzione: Debug comunicazione
ros2 topic list
ros2 topic echo /user_input
ros2 node list</div>

    <h2>9.4 Errori di Dipendenze</h2>
    
    <div class="code-block"># Problema: "Missing Python dependencies"
# Soluzione: Installazione dipendenze mancanti
pip3 install rclpy std_msgs sensor_msgs

# Problema: "Webots Python API not found"
# Soluzione: Configurazione PYTHONPATH
export PYTHONPATH=$PYTHONPATH:/usr/local/webots/lib/python3.10/site-packages</div>

    <div class="warning-box">
        <strong>⚠️ Troubleshooting Avanzato:</strong><br>
        Se i problemi persistono, verificare la compatibilità delle versioni software e consultare i log dettagliati in <code>log/</code> generati da colcon build.
    </div>

    <div class="page-break"></div>

    <h1>10. CONCLUSIONI</h1>

    <h2>10.1 Risultati Ottenuti</h2>
    
    <p>Il progetto <strong>NAO Library Assistant</strong> ha raggiunto tutti gli obiettivi prefissati, dimostrando un'efficace integrazione tra tecnologie robotiche avanzate:</p>

    <div class="success-box">
        <strong>🎯 Obiettivi Raggiunti:</strong>
        <ul>
            <li><strong>✅ Simulazione Completa</strong>: Sistema robotico completamente funzionale</li>
            <li><strong>✅ Integrazione ROS2-Webots</strong>: Bridge stabile e performante</li>
            <li><strong>✅ Navigazione Autonoma</strong>: Percorsi ottimizzati e affidabili</li>
            <li><strong>✅ Interfaccia Utente</strong>: Interazione intuitiva e responsive</li>
        </ul>
    </div>

    <h2>10.2 Impatto Tecnologico</h2>
    
    <p>Il progetto dimostra come l'integrazione di tecnologie mature (ROS2) con simulatori avanzati (Webots) possa produrre sistemi robotici sofisticati e praticamente utilizzabili. L'approccio modulare adottato rappresenta un modello replicabile per futuri sviluppi nel campo della robotica di servizio.</p>

    <div class="success-box">
        <strong>🌟 Contributo Scientifico:</strong><br>
        Questo lavoro contribuisce al corpus di conoscenze sulla <strong>robotica di servizio</strong>, dimostrando metodologie efficaci per l'integrazione di sistemi complessi e fornendo un template riutilizzabile per progetti similari.
    </div>

    <h2>10.3 Considerazioni Finali</h2>
    
    <p>Il sistema <strong>NAO Library Assistant</strong> rappresenta un esempio concreto di come la robotica moderna possa essere applicata a contesti quotidiani per migliorare l'efficienza e l'esperienza utente. L'integrazione riuscita tra ROS2 e Webots apre la strada a sviluppi futuri sempre più sofisticati nel campo dell'automazione intelligente.</p>

    <p>La documentazione completa, la struttura modulare del codice e l'attenzione alla manutenibilità rendono questo progetto non solo un successo tecnico, ma anche un'importante risorsa didattica per lo studio della robotica avanzata.</p>

    <hr style="margin-top: 1cm; border: 2px solid #333;">
    
    <div style="text-align: center; margin-top: 2cm; font-style: italic; color: #666;">
        <strong>Fine della Relazione Tecnica</strong><br>
        Sistema NAO Library Assistant con Integrazione ROS2-Webots<br>
        Petrone Kevin, Di Peri Marta, Cirincione Marika<br>
        Giugno 2025
    </div>

</body>
</html>
